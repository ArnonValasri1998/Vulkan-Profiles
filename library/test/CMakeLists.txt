set(CMAKE_POSITION_INDEPENDENT_CODE ON)

function(add_unit_test NAME)
	set(TEST_FILE ./${NAME}.cpp)
    set(TEST_NAME library_${NAME})

    add_executable(${TEST_NAME} ${TEST_FILE})
    target_link_libraries(${TEST_NAME} PRIVATE gtest gtest_main Vulkan::Headers Vulkan::Profiles vulkan)
    add_dependencies(${TEST_NAME} library_profiles)
    add_test(NAME ${TEST_NAME} COMMAND ${TEST_NAME} --gtest_catch_exceptions=0)
endfunction(add_unit_test)

add_unit_test(test_api_create_device)
add_unit_test(test_api_get_profiles_beta)
add_unit_test(test_api_get_profiles_core)
add_unit_test(test_api_get_profile_extensions)
add_unit_test(test_api_get_profile_formats)
add_unit_test(test_api_get_profile_memory_types)
add_unit_test(test_api_get_profile_queue_families)
add_unit_test(test_api_get_profile_structures)
add_unit_test(test_api_get_profile_support)
add_unit_test(test_profile_support)
add_unit_test(test_profile_examples)
add_unit_test(test_util)